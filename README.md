<div class="row">
  <div class="column"><img src="https://github.com/analiticafp/Caracterizacion gripos de valor/blob/2154b2dc3f0b3c539b43a51c9fb71b9422a16f78/imagenes/layout_set_logo.png" align="left" alt="Función Pública"></div>
  <div class="column" align="center"><div><b>Documentación proyecto analítica V.1</b><br>Ultima actualización: Agosto de 2022</div>
</div>

<br>
<h1 >Caracterización grupos de valor</h1>

<h2>Participantes</h2>
<ul>
 <li type="circle">Monica Martínez, Teámitco,  mmartinez@funcionpublica.gov.co</li>
 <li type="circle">Maritza Ibarra Duarte, Analista de datos,  mibarra@funcionpublica.gov.co</li>
 <li type="circle">Miguel Sebastian Rincon Ortega, Analista de datos, mrincon@funcionpublica.gov.co</li>
</ul>

<h2>Problema</h2>
<p>El departamento administrativo de la Función Pública elabora anualmente el informe de caracterización de usuarios y grupos de valor con el objetivo de identificarlos caracterizarlos y enfocar los esfuerzos de la entidad para satisfacción de estos usuarios, Sin embargo, dicho informe no permite tener claridad de los servicios y productos atendidos en la entidad dado que no se incluyen todos los insumos de los canales, además las bases de datos no muestran la trazabilidad completa de las atenciones.</p>

<h2>Justificación</h2>
<p>La caracterización de usuarios permite aportar a la toma de decisiones basada en evidencia aumentando el conocimiento y siendo insumo fundamental para el diseño o mejora de la oferta institucional, canales de atención, estrategias de comunicación, canales de atención, estrategias de rendición de cuentas, mecanismos de participación ciudadana e implementación de políticas públicas, por lo tanto, se fortalece la relación usuario – entidad al identificar necesidades, expectativas y preferencias de los usuarios interesados.</p>
  
 
 <h2>Marco de referencia</h2>
  
  <table>
  <tr>
    <th>Marco contextual</th>
  </tr>
  <tr>
<p>Teniendo en cuenta la relevancia de la igualdad de derechos, oportunidades y responsabilidades entre hombre y mujeres, el gobierno nacional expidió la siguiente normatividad relacionada con la igual de género:</p> <br>
  
<li type="circle">Ley 581 de 2000 Por la cual se reglamenta la adecuada y efectiva participación de la mujer en los niveles decisorios de las diferentes ramas y órganos del   poder público, de conformidad con los artículos 13, 40 y 43 de la Constitución Nacional.</li><br>
    
<li type="circle">Decreto 1083 de 2015, el cual establece reglas para garantizar la equidad y la igualdad de oportunidades de las mujeres en la provisión de los empleos de nivel directivo en la Rama Ejecutiva del orden nacional y territorial.</li><br>  
  
<li type="circle">CONPES 3918 de 2018 el cual define lineamientos para la efectiva implementación de los Objetivos de Desarrollo Sostenible (ODS) en Colombia y define una meta a través del indicador relacionado con el Máximo Nivel Decisorio (MND) y Otros Niveles Decisorios (OND) a través del indicador denominado participación de la mujer en los cargos directivos.</li><br>

A partir de lo anterior y con el fin de dar cumplimiento a la normatividad anteriormente mencionada, Función Pública invita anualmente a las entidades publicas mediante circular externa para que suministren la información relacionada con la participación femenina en cargos de máximo nivel decisorio y otros niveles decisorios, mediante el diligenciamiento del aplicativo virtual desarrollarlo para tal fin. Una vez recepcionada la información se procede al cálculo del indicador, elaboración y publicación del informe correspondiente.</td>
  
<div>
<h2>Objetivos</h2>
 <p><b>Obejtivos del Negocio</b><br>
Identificar los perfiles de los usuarios y grupos de valor y como interactuan estos con la entidad.<br>

<b>Objetivo de la Mineria de datos:</b><br>
 <ul>

 <li type="circle">Realizar analisis de datos de los diferentes canales de atención que permitan identificar los grupos de valor de la entidad.</li>
<li type="circle">Analizar el comportamiento de los canales de atención.</li>
<li type="circle">Caracterizar los diferentes grupos de valor de la entidad.</li>
    <ul>
</p>
</div>
   
<h2>Criterios de Éxito</h2>
   <p>Desde el punto de vista de negocio, se puede considerar como criterio de éxito lograr la caracterización del 100% de las atenciones realizadas por Función Pública a los diferentes usuarios.</p>

<div>  
<h2>Riesgos y contingencias</h2>
   <p>  
    <ul>
 <li type="circle">Información Incompleta. </li>
<li type="circle">Información con estructuras y campos diferentes en cada canal de atención.</li>
    <ul>  
   </p>
</div>
  
<h2>Costos y beneficios</h2>
      <p>El desarrollo de este ejercicio de analítica de datos no genera costos para la entidad, dado que se realizará tomando como fuentes de información reportes generados por los diferentes canales de atención.<br>
      
Como beneficios se pueden mencionar que el desarrollo de estos ejercicios son un valor agregado para la entidad al contar con información confiable, de fácil acceso, con procedimientos y metodologías reconocidas y estandarizadas que respaldan las cifras. De otra parte, se puede decir que con los resultados obtenidos se pueden contar con una caracterización más detallada de los grupos de valor, así como identificar oportunidades de mejora aplicables a la forma como se capturan los datos en los canales de atención así como a los procedimientos para el diligenciamiento de los aplicativos destinados a tal fin, qiue permitan enfocar los esfuerzos de la entidad en la atención de estos grupos.</p>

 <div>
 <h2>Productos/Entregables</h2>
 <ul>
 <li type="circle">Base de datos consolidada y estructurada con el total de interacciones de los grupos de valor del año 2021 y de enero a julio de 2022.</li>
 <li type="circle">Gráficos descriptivos que permiten caracterizar las interacciones y los grupos de valor de la entidad.</li>
 <ul>
 </div>
   
 <h2>Metodología y Alcance</h2>
   <p><b>Metodología:</b>  Para el desarrollo de este ejercicio se aplicará la metodologia Crisp DM, en la cual se inicia con con análisis y entendimiento del negocio y objetivos del ejercicios y, posteriormente, se realiza una revisión y entendimiento de los datos y preparación de los mismos, para luego pasar a la fase de modelamiento donde se aplican las técnicas estadísticas y algoritmos desarrollados para dar cumplimiento a los objetivos. Para este caso puntal, se aplicará analítica de texto y, finalmente, se realizará la evaluación del modelo y se procederá a la entrega de resultados e informe final.</li><br>
   
<b>Alcance:</b>  Para este ejercicio se aplicarán técnicas de mineria de datos a la información de las bases de datos de los reportes de: Orfeo, crm, cursos eva, chat del año 2021 y de enero a julio de 2022.</p>

<h2>Recursos tecnológicos del proyecto</h2>
<table>
   <tr>
    <th colspan="3">Descripción de software</th>
  </tr>
  <tr>
    <th>Software</th>
    <th>Justificación</th>
    <th>Archivos generados</th>
  </tr>
  <tr>
    <td>Python</td>
    <td>Lenguaje de programación open source y con respaldo de una gran comunidad que permitirá emprender acciones de transformación y extracción de información útil para la toma de decisiones, bajo el ciclo de vida de ejercicios no supervisados se dictaminan las tareas principalmente de preparación de datos, aprendizaje, evaluación y perfilamiento de los datos.</td>
    <td>Notebook Jupyter (algoritmo): se emprende y explica el proceso para análisis de datos en el proyecto puede establecerse en formato PDF, HTML u otros para su consulta</td>
  </tr>
</table>

 
 <h2>Presentación y análisis de resultados</h2>
   
<h3>Preparación de datos</h3>
  <p>Se realizó la integración en una base en Excel de la información asociada al indicador de ley de cuotas desde la vigencia 2004 hasta 2021, características de las entidades públicas presentes en SIGEP y vinculación en SIGEP por tipo de planta. Por otro lado, se eliminaron variables que bajo el criterio de los participantes del negocio no aportan a la consecución del proyecto. Es necesario realizar una descripción estadística de los datos que propende por el conocimiento acerca de los datos.</p> 
<p>La base de las características de las entidades publicas tiene 6.403 registros asociados a entidades de orden nacional y territorial. Por otro lado, y para determinar si la entidad debe reportar la participación de la mujer en cargos directivos se tomaron datos de la vinculación de los servidores públicos del SIGEP según su tipo de cargo, en este caso si presenta o no cargos de libre nombramiento y remoción donde se tenía información de 670 de las 6.403 entidades.</p> 
<p>Observe en el siguiente grafico las frecuencias de las variables que fueron tenidas en cuenta para el ejercicio predictivo.</p> 

 <div>   
<img src="https://github.com/analiticafp/Ley-de-cuotas-2021/blob/f9981bb1f352bbad2eca1e64e05bab8550f49ba3/imagenes/conteo-frecuencia.png" align="center" alt="Función Pública">
</div> 
  
<p>Vemos como en algunos casos según el valor de la variable la tendencia es que debe reportar tanto para el orden nacional y las cabezas de sector, además puede observarse según el tipo de institución, la clasificación orgánica y el nivel de institución valores dentro del dominio donde no se debe reportar.</p>
<table align="center">
  <tr>
    <th>Variable</th>
    <th>Proporción de campos con valor (%)</th>
  </tr>
  <tr>
    <td>COD_INSTITUCION</td>
    <td>100</td>
  </tr> 
    <tr>
    <td>NOMBRE</td>
    <td>100</td>
  </tr> 
       <tr>
    <td>CATEGORIAMUNI</td>
    <td>100</td>
  </tr> 
           <tr>
    <td>CLASIFICACION_ORGANICA</td>
    <td>100</td>
  </tr> 
           <tr>
    <td>NATURALEZA_JURIDICA</td>
    <td>100</td>
  </tr> 
           <tr>
    <td>ORDEN</td>
    <td>100</td>
  </tr> 
           <tr>
    <td>ES_CABEZA_S</td>
    <td>98.95</td>
  </tr> 
           <tr>
    <td>NIVEL_INSTITUCION</td>
    <td>100</td>
  </tr> 
           <tr>
    <td>TIPO_INSTITUCION</td>
    <td>100</td>
  </tr> 
   </table>
   
 <p>Ahora bien, para la limpieza de datos se evalúa la existencia de campos nulos o vacíos donde dichas variables fueron objeto de un proceso de imputación.</p>  
 <p>En el ejercicio fue necesario crear variables a partir de los dominios encontrados en algunas variables, variables de 1 y 0, esto ocurre para toda la base. De la misma forma se evalúan correlaciones con la variable “debe reportar” y las variables con una correlación baja menor a 0.1 se eliminan del modelo, ya para terminar se realizó balanceo de datos.</p>
  
  <div>   
<img src="https://github.com/analiticafp/Ley-de-cuotas-2021/blob/f9981bb1f352bbad2eca1e64e05bab8550f49ba3/imagenes/corr.png" align="center" alt="Función Pública">
</div> 
  
 <h3>División de datos</h3>
  
  <p>Se realizó una división simple de 70% entrenamiento y 30% de prueba con los parámetros mostrados a continuación.</p>
  
```python
  from sklearn.model_selection import train_test_split
  X_train, X_test, y_train, y_test = train_test_split(X, Y, test_size=0.3, random_state=1, stratify=Y)
  ```
 <h3>Aprendizaje</h3>
  <p>La predicción es un problema de clasificación entre si debe reportar y no debe reportar de las entidades que aun desconocemos parte de su información, para este ejercicio se toman dos algoritmos de aprendizaje supervisado “KNN Classifiers” el cual aplica un método sencillo que utiliza las instancias de datos más similares para hacer la clasificación y “Random Forest” compuesto por arboles de decisión los cuales aportan a la clasificación final del modelo.</p>
  <p>Los modelos finales y su configuración se exponen a continuación, tenga en cuenta que dichos modelos fueron evaluados para su mejor configuración en cuanto a precisión. </p>
  
```python
  from sklearn.ensemble import RandomForestClassifier
  SEED = 42
  random_forest_model_0 = RandomForestClassifier(random_state = SEED, n_estimators=7)
  random_forest_model_0.fit(X_train, y_train.values.ravel())
  
  from sklearn.neighbors import KNeighborsClassifier
  knn_model_feat = KNeighborsClassifier(n_neighbors=5, n_jobs=-1)
  knn_model_feat.fit(X_train, y_train.values.ravel())
  ```
 <h3>Evaluación</h3>
 <p>La matriz de confusión nos muestra en este caso el resultado de la validación con el conjunto de prueba, el modelo “KNN” con una precisión del 85% y en su clasificación en general presenta mejores clasificaciones que el modelo entrenado con “Random Forests”.</p>
 <div>   
<img src="https://github.com/analiticafp/Ley-de-cuotas-2021/blob/17177b9d78645ece32859ea946b7d9cc6015449d/imagenes/rf-c.png" align="center" alt="Función Pública">
</div> 
 <h3>Predicción futura</h3>
  <p>Ahora bien se realiza la predicción utilizando el modelo con mejores resultados, se toma toda la base de entidades y se realiza su clasificación que se refleja en la columna “predicción” del conjunto de datos.</p>
 
```python
  df['PREDICT'] = random_forest_model_0.predict(dftest)
  #Salida en excel
  df.to_excel('predicted.xlsx', sheet_name='example')
  ``` 
  
 <p>Si en nuestra observación planteamos los que deben reportar se acerca a 3.646 de 6.319 entidades donde su estado no es “inactivo”.</p>
  
 <h3>Análisis resultado del indicador de ley de cuotas en vigencias posteriores - regresión lineal</h3>
<p>Teniendo en cuenta el reporte de ley de cuotas desde 2004 hasta 2021, se toma el cálculo del porcentaje de participación femenina en niveles decisorios para construir una relación lineal simple. El resultado de la regresión lineal es una ecuación lineal que permite identificar como parámetro de mayor utilidad la pendiente y con ello el aumento porcentual promedio por año del indicador. En los puntos verdes se indica el aumento de la cuota femenina para los años 2022, 2023,2024 y 2025 si se hiciera uso de este modelo.  </p>  
   <div>   
<img src="https://github.com/analiticafp/Ley-de-cuotas-2021/blob/84d6c33cd69acc817f0c893c44b58a806da795f3/imagenes/linear-r.png" align="center" alt="Función Pública">
</div> 
  
<p>Para la predicción se utiliza la función lineal encontrada con los datos históricos, lo que refleja una aproximación al indicador para vigencias posteriores.  </p>

<h2>Conclusiones</h2>
<p> Una vez analizadas las bases de datos de los reportes de ley de coutas realizadas por las entidades en el aplicativo diseñado para tal fin, para el periodo de 2016 a 2020, se puede concluir que:</p><br> 
   
<li type="circle">El resultado de las entidades que no deben repotar en su mayoría corresponden a Asambleas departamentales, consejos municipales, personerias municipales de municipios de 5 y 6 categoria </li>
 <br>  

 <div>   
<img src="https://github.com/analiticafp/Ley-de-cuotas-2021/blob/4a6be97316f6334d45d8bd1766c162e55359a031/imagenes/Entidades-que-no-deben-reportar.jpg" align="center" alt="Función Pública">
</div> 
  
<li type="circle">El modelo entrenado con el algoritmo “KNN” obtuvo una precisión del 85% igual al “Random Forests” lo que permitió clasificar 6.319 entidades encontrando un universo de posibles candidatos a reporte de ley de cuotas donde 3.646 entidades deben reportar. </li><br>
  
<li type="circle">La regresión lineal simple presenta importantes limitaciones como herramienta predictiva, sin embargo para el caso de estudio muestra un escenario de aumento constante del indicador de participación femenina en cargos de niveles decisorios, en donde aún así se mantendría por debajo del 50% en los próximos 3 años.</li><br>

</ul>
 <h2>Recomendaciones</h2>
 <p>Desde la Oficina Asesora de Planeación y el equipo de trabajo que desarrollo este ejercicio se sugiere lo siguiente:</p>
  
<li type="circle">Fortalecer campañas de sensibilización con las entidades públicas de orden nacional y territorial para que realicen la actualización de los servidores públicos vinculados</li><br> 
  
<li type="circle">Se sugiere que la base de servidores vinculados del SIGEP se tenga en como la fuente primaria para la generación del indicador, dado que de acuerdo con el análisis realizado representa el 91% del universo de entidades que deberían reportar</li><br> 

  
<li type="circle">Se sugiere tener o mantener la misma estructura de los informes y de garantizar que las entidades o el universo aplicable a ley de cuotas tengan reportes frecuentes vigencia tras vigencia.</li><br> 
  
<li type="circle">Se sugiere realizar validación de 173 entidades de orden territorial con categoría municipal 5 y 6 que no han realizado reporte en años anteriores y tampoco se encuentran en el SIGEP y el modelo predice que para años siguientes deberían reportar.</li><br> 

 
     
<h2>Bibliografía</h2>  
<ul>
<li type="circle">[Sebastian Raschka, Vahid Mirjalili] <i>Python Machine Learning</i>. Marcombo, 2019.</li>
<li type="circle">[Dirección de Empleo Público] <i>Informes de Ley de Cuotas</i>. Función Pública, 2020.</li>
</ul>  
